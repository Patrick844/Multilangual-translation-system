

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>lingowiz package &mdash; LingoWiz  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            LingoWiz
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">lingowiz package</a><ul>
<li><a class="reference internal" href="#submodules">Submodules</a></li>
<li><a class="reference internal" href="#module-lingowiz.converter">lingowiz.converter module</a><ul>
<li><a class="reference internal" href="#lingowiz.converter.decompress_gz"><code class="docutils literal notranslate"><span class="pre">decompress_gz()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.converter.parse_tmx"><code class="docutils literal notranslate"><span class="pre">parse_tmx()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-lingowiz.data_prep">lingowiz.data_prep module</a><ul>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#main-classes-and-functions">Main Classes and Functions</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#example-usage">Example Usage</a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.add_space_between_letters_and_numbers"><code class="docutils literal notranslate"><span class="pre">add_space_between_letters_and_numbers()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.detect_language"><code class="docutils literal notranslate"><span class="pre">detect_language()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.expand_abbreviations"><code class="docutils literal notranslate"><span class="pre">expand_abbreviations()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.format_table"><code class="docutils literal notranslate"><span class="pre">format_table()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.get_language_code"><code class="docutils literal notranslate"><span class="pre">get_language_code()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.handle_english_contractions"><code class="docutils literal notranslate"><span class="pre">handle_english_contractions()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.lowercase_text"><code class="docutils literal notranslate"><span class="pre">lowercase_text()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.lowercase_turkish"><code class="docutils literal notranslate"><span class="pre">lowercase_turkish()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.normalize_french_accents"><code class="docutils literal notranslate"><span class="pre">normalize_french_accents()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.normalize_french_punctuation"><code class="docutils literal notranslate"><span class="pre">normalize_french_punctuation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.normalize_greek_accents"><code class="docutils literal notranslate"><span class="pre">normalize_greek_accents()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.normalize_italian_punctuation"><code class="docutils literal notranslate"><span class="pre">normalize_italian_punctuation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.normalize_spanish_accents"><code class="docutils literal notranslate"><span class="pre">normalize_spanish_accents()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.normalize_turkish_punctuation"><code class="docutils literal notranslate"><span class="pre">normalize_turkish_punctuation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_english"><code class="docutils literal notranslate"><span class="pre">preprocess_english()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_french"><code class="docutils literal notranslate"><span class="pre">preprocess_french()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_greek"><code class="docutils literal notranslate"><span class="pre">preprocess_greek()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_italian"><code class="docutils literal notranslate"><span class="pre">preprocess_italian()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_romania"><code class="docutils literal notranslate"><span class="pre">preprocess_romania()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_russian"><code class="docutils literal notranslate"><span class="pre">preprocess_russian()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_spanish"><code class="docutils literal notranslate"><span class="pre">preprocess_spanish()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.preprocess_turkish"><code class="docutils literal notranslate"><span class="pre">preprocess_turkish()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.process_medical_data"><code class="docutils literal notranslate"><span class="pre">process_medical_data()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.rm_whitespace"><code class="docutils literal notranslate"><span class="pre">rm_whitespace()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.data_prep.update_rows_2"><code class="docutils literal notranslate"><span class="pre">update_rows_2()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-lingowiz.inference">lingowiz.inference module</a><ul>
<li><a class="reference internal" href="#id1">Features:</a></li>
<li><a class="reference internal" href="#id2">Dependencies:</a></li>
<li><a class="reference internal" href="#usage-example">Usage Example:</a></li>
<li><a class="reference internal" href="#lingowiz.inference.chunk_data"><code class="docutils literal notranslate"><span class="pre">chunk_data()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.compute_confidence"><code class="docutils literal notranslate"><span class="pre">compute_confidence()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.compute_rating"><code class="docutils literal notranslate"><span class="pre">compute_rating()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.detect_language"><code class="docutils literal notranslate"><span class="pre">detect_language()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.direct_translation"><code class="docutils literal notranslate"><span class="pre">direct_translation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.generating_translation"><code class="docutils literal notranslate"><span class="pre">generating_translation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.indirect_translation"><code class="docutils literal notranslate"><span class="pre">indirect_translation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.inference"><code class="docutils literal notranslate"><span class="pre">inference()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.initializing_model"><code class="docutils literal notranslate"><span class="pre">initializing_model()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.initializing_tokenizer"><code class="docutils literal notranslate"><span class="pre">initializing_tokenizer()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.mlflow_logging"><code class="docutils literal notranslate"><span class="pre">mlflow_logging()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.process_chunk"><code class="docutils literal notranslate"><span class="pre">process_chunk()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference.processing"><code class="docutils literal notranslate"><span class="pre">processing()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-lingowiz.inference_preprocessing">lingowiz.inference_preprocessing module</a><ul>
<li><a class="reference internal" href="#classes">Classes:</a></li>
<li><a class="reference internal" href="#methods">Methods:</a></li>
<li><a class="reference internal" href="#utilities">Utilities:</a></li>
<li><a class="reference internal" href="#usage">Usage:</a></li>
<li><a class="reference internal" href="#id3">Dependencies:</a></li>
<li><a class="reference internal" href="#note">Note:</a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor</span></code></a><ul>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.language"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.language</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_english"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_english()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_french"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_french()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_greek"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_greek()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_italian"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_italian()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_romania"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_romania()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_russian"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_russian()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_spanish"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_spanish()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_turkish"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.preprocess_turkish()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.inference_preprocessing.TextPreprocessor.process"><code class="docutils literal notranslate"><span class="pre">TextPreprocessor.process()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#module-lingowiz.metrics">lingowiz.metrics module</a><ul>
<li><a class="reference internal" href="#lingowiz.metrics.evaluation"><code class="docutils literal notranslate"><span class="pre">evaluation()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.metrics.metric_compute"><code class="docutils literal notranslate"><span class="pre">metric_compute()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.metrics.mlflow_logging"><code class="docutils literal notranslate"><span class="pre">mlflow_logging()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.metrics.translation"><code class="docutils literal notranslate"><span class="pre">translation()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-lingowiz.train">lingowiz.train module</a><ul>
<li><a class="reference internal" href="#id4">Features:</a></li>
<li><a class="reference internal" href="#id5">Dependencies:</a></li>
<li><a class="reference internal" href="#id6">Example Usage:</a></li>
<li><a class="reference internal" href="#lingowiz.train.EmptyCacheCallback"><code class="docutils literal notranslate"><span class="pre">EmptyCacheCallback</span></code></a><ul>
<li><a class="reference internal" href="#lingowiz.train.EmptyCacheCallback.on_epoch_end"><code class="docutils literal notranslate"><span class="pre">EmptyCacheCallback.on_epoch_end()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#lingowiz.train.initialize"><code class="docutils literal notranslate"><span class="pre">initialize()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.train.log_params"><code class="docutils literal notranslate"><span class="pre">log_params()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.train.split_eval"><code class="docutils literal notranslate"><span class="pre">split_eval()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.train.split_test"><code class="docutils literal notranslate"><span class="pre">split_test()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.train.tokenize_function"><code class="docutils literal notranslate"><span class="pre">tokenize_function()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.train.train"><code class="docutils literal notranslate"><span class="pre">train()</span></code></a></li>
<li><a class="reference internal" href="#lingowiz.train.training_pipeline"><code class="docutils literal notranslate"><span class="pre">training_pipeline()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-lingowiz.utils">lingowiz.utils module</a></li>
<li><a class="reference internal" href="#module-lingowiz">Module contents</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">LingoWiz</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">lingowiz package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/lingowiz.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="lingowiz-package">
<h1>lingowiz package<a class="headerlink" href="#lingowiz-package" title="Link to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading"></a></h2>
</section>
<section id="module-lingowiz.converter">
<span id="lingowiz-converter-module"></span><h2>lingowiz.converter module<a class="headerlink" href="#module-lingowiz.converter" title="Link to this heading"></a></h2>
<p>Module Name: converter.py</p>
<p>This module contains functions for converting
decompressing tmx files (decompres_gz)
and convert them to CSV (parse_tmx)</p>
<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.converter.decompress_gz">
<span class="sig-prename descclassname"><span class="pre">lingowiz.converter.</span></span><span class="sig-name descname"><span class="pre">decompress_gz</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/converter.html#decompress_gz"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.converter.decompress_gz" title="Link to this definition"></a></dt>
<dd><p>Decompress Large TMX files</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> (<em>str</em>) – Name of the input file</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Name of the output file</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.converter.parse_tmx">
<span class="sig-prename descclassname"><span class="pre">lingowiz.converter.</span></span><span class="sig-name descname"><span class="pre">parse_tmx</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/lingowiz/converter.html#parse_tmx"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.converter.parse_tmx" title="Link to this definition"></a></dt>
<dd><p>Parsing document from tmx</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_file</strong> (<em>str</em>) – Name of input_file</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Name of output_file</p></li>
<li><p><strong>source</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – <ul>
<li><p><strong>source_lang (str)</strong>: Source language</p></li>
<li><p><strong>source_code (str)</strong>: Source code</p></li>
</ul>
</p></li>
<li><p><strong>target</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – <ul>
<li><p><strong>target_lang (str)</strong>: Target language</p></li>
<li><p><strong>target_code (str)</strong>: Target code</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lingowiz.data_prep">
<span id="lingowiz-data-prep-module"></span><h2>lingowiz.data_prep module<a class="headerlink" href="#module-lingowiz.data_prep" title="Link to this heading"></a></h2>
<p>Module Name: data_prep.py</p>
<p>This module provides functionality for preprocessing text data in various languages,
formatting dataframes, and preparing datasets for training machine translation models
like MarianMT.</p>
<section id="features">
<h3>Features<a class="headerlink" href="#features" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p>Language-specific preprocessing functions for:
- English
- French
- Italian
- Russian
- Turkish
- Spanish
- Greek
- Romanian</p></li>
<li><p>General utility functions for:
- Removing whitespace
- Expanding abbreviations
- Normalizing text (e.g., punctuation, accents)</p></li>
<li><p>Automatic language detection using FastText.</p></li>
<li><p>Integration with MLflow for tracking data inputs.</p></li>
<li><p>Processes source and target language columns for fine-tuning MarianMT.</p></li>
</ul>
</section>
<section id="main-classes-and-functions">
<h3>Main Classes and Functions<a class="headerlink" href="#main-classes-and-functions" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Text Preprocessing Functions:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_english(text)</span></code>: Handles English-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_french(text)</span></code>: Handles French-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_italian(text)</span></code>: Handles Italian-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_russian(text)</span></code>: Handles Russian-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_turkish(text)</span></code>: Handles Turkish-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_spanish(text)</span></code>: Handles Spanish-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_greek(text)</span></code>: Handles Greek-specific preprocessing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_romania(text)</span></code>: Handles Romanian-specific preprocessing.</p></li>
</ul>
</dd>
<dt>Utility Functions:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">get_language_code(language_name)</span></code>: Retrieves ISO 639-3 language codes.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detect_language(row,</span> <span class="pre">src,</span> <span class="pre">model)</span></code>: Detects source and target languages in a DataFrame row.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rm_whitespace(text)</span></code>: Removes unnecessary whitespace from text.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">handle_english_contractions(text)</span></code>: Expands English contractions.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">expand_abbreviations(text)</span></code>: Expands abbreviations using a dictionary.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format_table(filepath,</span> <span class="pre">source,</span> <span class="pre">output_file)</span></code>: Processes a CSV file, normalizes text, and prepares data for training.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="dependencies">
<h3>Dependencies<a class="headerlink" href="#dependencies" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>: For handling tabular data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code>: For progress bars during processing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">camel_tools</span></code>: For Arabic text normalization and diacritic removal.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">langcodes</span></code>: For handling language code lookups.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">huggingface_hub</span></code>: For downloading FastText models.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fasttext</span></code>: For language detection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mlflow</span></code>: For tracking input data for machine learning pipelines.</p></li>
</ul>
</section>
<section id="example-usage">
<h3>Example Usage<a class="headerlink" href="#example-usage" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">data_prep</span> <span class="kn">import</span> <span class="n">format_table</span>

<span class="c1"># Preprocess a CSV file for fine-tuning MarianMT</span>
<span class="n">format_table</span><span class="p">(</span>
    <span class="n">filepath</span><span class="o">=</span><span class="s2">&quot;input_data.csv&quot;</span><span class="p">,</span>
    <span class="n">source</span><span class="o">=</span><span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">output_file</span><span class="o">=</span><span class="s2">&quot;processed_data.csv&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.add_space_between_letters_and_numbers">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">add_space_between_letters_and_numbers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#add_space_between_letters_and_numbers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.add_space_between_letters_and_numbers" title="Link to this definition"></a></dt>
<dd><p>Adds spaces between letters and numbers in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text containing letters and numbers.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with spaces inserted between letters and numbers.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses regular expressions to identify and separate letters from numbers.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.detect_language">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">detect_language</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#detect_language"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.detect_language" title="Link to this definition"></a></dt>
<dd><p>Performs automatic language detection and filters out invalid
detections.</p>
<p>This function detects the source and target languages in a given row using a language
detection model. If an error occurs during detection, the function returns <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (<em>dict</em>) – A single row containing source and target language text.</p></li>
<li><p><strong>src</strong> (<em>str</em>) – The name of the source column in the row.</p></li>
<li><p><strong>model</strong> (<em>object</em>) – The model used for language detection, expected to have a <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple containing:
- str: Code of the source language.
- str: Code of the target language.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If the required keys are missing from the row dictionary.</p></li>
<li><p><strong>AttributeError</strong> – If the model object does not have a <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p></li>
<li><p><strong>ValueError</strong> – If the text preprocessing or model output is invalid.</p></li>
<li><p><strong>Exception</strong> – For any other unexpected errors.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In case of an error during language detection, the function returns <code class="docutils literal notranslate"><span class="pre">(None,</span> <span class="pre">None)</span></code>
instead of raising the exception.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.expand_abbreviations">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">expand_abbreviations</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#expand_abbreviations"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.expand_abbreviations" title="Link to this definition"></a></dt>
<dd><p>Expands abbreviations in the text based on a predefined abbreviation
dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text containing abbreviations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with abbreviations expanded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function uses a dictionary (<cite>abbreviation_dict</cite>) to replace
abbreviations with their corresponding expanded forms.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>KeyError</strong> – If the abbreviation key is not found in the dictionary.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.format_table">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">format_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/lingowiz/data_prep.html#format_table"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.format_table" title="Link to this definition"></a></dt>
<dd><p>Preprocesses a CSV file for MarianMT fine-tuning by normalizing text and
adding language-specific tags.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filepath</strong> (<em>str</em>) – Path to the input CSV file.</p></li>
<li><p><strong>source</strong> (<em>str</em>) – Name of the source language (e.g., ‘French’).</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Path to save the processed CSV file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The function writes the processed data directly to the output file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>FileNotFoundError</strong> – If the input CSV file does not exist.</p></li>
<li><p><strong>KeyError</strong> – If the required ‘Arabic’ column or the source language column is missing.</p></li>
<li><p><strong>Exception</strong> – For any unexpected errors during processing.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">format_table</span><span class="p">(</span><span class="s2">&quot;data_fr.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;French&quot;</span><span class="p">,</span> <span class="s2">&quot;processed_data.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.get_language_code">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">get_language_code</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">language_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/lingowiz/data_prep.html#get_language_code"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.get_language_code" title="Link to this definition"></a></dt>
<dd><p>Retrieves the ISO 639-3 language code from the given language name using
langcodes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>language_name</strong> (<em>str</em>) – The name of the language (e.g., “French”).</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The ISO 639-3 code for the language, or <code class="docutils literal notranslate"><span class="pre">None</span></code> if the language is not found.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>LookupError</strong> – If the language code cannot be found.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">get_language_code</span><span class="p">(</span><span class="s2">&quot;French&quot;</span><span class="p">)</span>  <span class="c1"># Returns &#39;fra&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.handle_english_contractions">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">handle_english_contractions</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#handle_english_contractions"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.handle_english_contractions" title="Link to this definition"></a></dt>
<dd><p>Expands English contractions in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in English.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with contractions expanded.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.lowercase_text">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">lowercase_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#lowercase_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.lowercase_text" title="Link to this definition"></a></dt>
<dd><p>Converts the input text to lowercase.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text to convert to lowercase.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text converted to lowercase.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.lowercase_turkish">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">lowercase_turkish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#lowercase_turkish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.lowercase_turkish" title="Link to this definition"></a></dt>
<dd><p>Converts Turkish text to lowercase, handling special Turkish characters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Turkish.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text converted to lowercase with Turkish-specific characters handled.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.normalize_french_accents">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">normalize_french_accents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#normalize_french_accents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.normalize_french_accents" title="Link to this definition"></a></dt>
<dd><p>Standardizes French accents in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in French.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with accents normalized.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.normalize_french_punctuation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">normalize_french_punctuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#normalize_french_punctuation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.normalize_french_punctuation" title="Link to this definition"></a></dt>
<dd><p>Normalizes French punctuation in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in French.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with punctuation normalized.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.normalize_greek_accents">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">normalize_greek_accents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#normalize_greek_accents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.normalize_greek_accents" title="Link to this definition"></a></dt>
<dd><p>Normalizes Greek text accents using Unicode NFC normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Greek.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with normalized Greek accents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.normalize_italian_punctuation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">normalize_italian_punctuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#normalize_italian_punctuation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.normalize_italian_punctuation" title="Link to this definition"></a></dt>
<dd><p>Normalizes Italian punctuation in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Italian.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with normalized Italian punctuation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.normalize_spanish_accents">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">normalize_spanish_accents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#normalize_spanish_accents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.normalize_spanish_accents" title="Link to this definition"></a></dt>
<dd><p>Normalizes Spanish accents in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Spanish.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with normalized Spanish accents.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.normalize_turkish_punctuation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">normalize_turkish_punctuation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#normalize_turkish_punctuation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.normalize_turkish_punctuation" title="Link to this definition"></a></dt>
<dd><p>Normalizes Turkish punctuation in the text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Turkish.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with normalized Turkish punctuation.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_english">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_english</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_english"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_english" title="Link to this definition"></a></dt>
<dd><p>Preprocesses English text by applying multiple transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in English.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text after applying all English-specific transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_french">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_french</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_french"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_french" title="Link to this definition"></a></dt>
<dd><p>Preprocesses French text by applying specific transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in French.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text after applying all French-specific transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_greek">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_greek</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_greek"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_greek" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Greek text by applying specific transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Greek.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text after applying all Greek-specific transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_italian">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_italian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_italian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_italian" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Italian text by applying specific transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Italian.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text after applying all Italian-specific transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_romania">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_romania</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_romania"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_romania" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Romanian text by applying transformations such as
lowercasing, punctuation removal, whitespace cleaning, and optional
diacritic normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Romanian.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed, normalized, and cleaned text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_russian">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_russian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_russian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_russian" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Russian text by removing unnecessary whitespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Russian.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text with whitespace removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_spanish">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_spanish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_spanish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_spanish" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Spanish text by applying specific transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Spanish.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text after applying all Spanish-specific transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.preprocess_turkish">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">preprocess_turkish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#preprocess_turkish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.preprocess_turkish" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Turkish text by applying specific transformations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text in Turkish.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text after applying all Turkish-specific transformations.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.process_medical_data">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">process_medical_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#process_medical_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.process_medical_data" title="Link to this definition"></a></dt>
<dd><p>Processes medical data by normalizing symbols, converting to lowercase,
expanding abbreviations, and adding spaces between letters and numbers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>data</strong> (<em>str</em>) – The input medical data text.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The processed and normalized medical data.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function ensures that medical data is in a standardized format
for downstream processing.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.rm_whitespace">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">rm_whitespace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/lingowiz/data_prep.html#rm_whitespace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.rm_whitespace" title="Link to this definition"></a></dt>
<dd><p>Removes unnecessary whitespace from the input text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text from which to remove unnecessary whitespace.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The text with unnecessary whitespace removed.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.data_prep.update_rows_2">
<span class="sig-prename descclassname"><span class="pre">lingowiz.data_prep.</span></span><span class="sig-name descname"><span class="pre">update_rows_2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">row</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/data_prep.html#update_rows_2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.data_prep.update_rows_2" title="Link to this definition"></a></dt>
<dd><p>Updates a DataFrame row with language-specific tags for MarianMT fine-tuning.</p>
<p>This function detects the source and target languages of a given row using a
language detection model. It appends the detected language codes as MarianMT
language tags (e.g., <code class="docutils literal notranslate"><span class="pre">&gt;&gt;eng&lt;&lt;</span></code>) to the source and target text columns. If the
target language is detected as <code class="docutils literal notranslate"><span class="pre">arb</span></code>, it is normalized to <code class="docutils literal notranslate"><span class="pre">ara</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> (<em>pandas.Series</em><em> or </em><em>dict</em>) – A single row of the DataFrame containing source and target language text.</p></li>
<li><p><strong>src</strong> (<em>str</em>) – The name of the source language column in the row (e.g., <code class="docutils literal notranslate"><span class="pre">English</span></code>).</p></li>
<li><p><strong>model</strong> (<em>object</em>) – The language detection model, expected to have a <code class="docutils literal notranslate"><span class="pre">predict</span></code> method.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The updated row with language tags appended to the source and target text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.Series or dict</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The target language code <code class="docutils literal notranslate"><span class="pre">arb</span></code> is replaced with <code class="docutils literal notranslate"><span class="pre">ara</span></code> for consistency.</p></li>
<li><p>If language detection fails (i.e., <code class="docutils literal notranslate"><span class="pre">code_input</span></code> or <code class="docutils literal notranslate"><span class="pre">code_target</span></code> is <code class="docutils literal notranslate"><span class="pre">None</span></code>), the function returns the original row without modification.</p></li>
</ul>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">row</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;English&quot;</span><span class="p">:</span> <span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;Arabic&quot;</span><span class="p">:</span> <span class="s2">&quot;مرحبا&quot;</span><span class="p">}</span>
<span class="n">updated_row</span> <span class="o">=</span> <span class="n">update_rows_2</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">src</span><span class="o">=</span><span class="s2">&quot;English&quot;</span><span class="p">,</span> <span class="n">model</span><span class="o">=</span><span class="n">language_model</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">updated_row</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-lingowiz.inference">
<span id="lingowiz-inference-module"></span><h2>lingowiz.inference module<a class="headerlink" href="#module-lingowiz.inference" title="Link to this heading"></a></h2>
<p>Module Name: inference_pipeline.py</p>
<p>This module provides a complete pipeline for processing, translating, and evaluating
text in multiple languages using fine-tuned MarianMT models. It includes utilities for
language detection, preprocessing, translation, confidence computation, grammar error
analysis, and logging results to MLflow.</p>
<section id="id1">
<h3>Features:<a class="headerlink" href="#id1" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><strong>Language Detection</strong>: Automatically detect the language of the input text using FastText.</p></li>
<li><p><strong>Preprocessing</strong>: Clean and preprocess text for specific languages before translation.</p></li>
<li><p><strong>Translation</strong>: Perform direct or indirect translation using MarianMT models and tokenizers.</p></li>
<li><p><strong>Confidence Calculation</strong>: Compute confidence scores for generated translations.</p></li>
<li><p><strong>Grammar Checking</strong>: Evaluate translations using grammar error analysis with LanguageTool.</p></li>
<li><p><strong>MLflow Logging</strong>: Log translation results, ratings, and metadata to MLflow experiments.</p></li>
<li><p><strong>Chunking</strong>: Handle large text by splitting it into manageable chunks for translation.</p></li>
</ul>
</section>
<section id="id2">
<h3>Dependencies:<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transformers</span></code>: For MarianMT models and tokenizers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fasttext</span></code>: For language detection.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">language_tool_python</span></code>: For grammar error checking.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mlflow</span></code>: For logging translations and metadata.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">huggingface_hub</span></code>: For downloading models.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch</span></code>: For confidence computation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code>: For progress bars during processing.</p></li>
</ul>
</section>
<section id="usage-example">
<h3>Usage Example:<a class="headerlink" href="#usage-example" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inference_pipeline</span> <span class="kn">import</span> <span class="n">inference</span>

<span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Bonjour tout le monde!&quot;</span>
<span class="n">translation</span><span class="p">,</span> <span class="n">source_languages</span><span class="p">,</span> <span class="n">ratings</span> <span class="o">=</span> <span class="n">inference</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Translation: </span><span class="si">{</span><span class="n">translation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source Languages: </span><span class="si">{</span><span class="n">source_languages</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ratings: </span><span class="si">{</span><span class="n">ratings</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.chunk_data">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">chunk_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#chunk_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.chunk_data" title="Link to this definition"></a></dt>
<dd><p>Splits the input text into smaller chunks for easier processing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunk_size</strong> (<em>int</em>) – Maximum number of words per chunk.</p></li>
<li><p><strong>text</strong> (<em>str</em>) – The input text to split.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of text chunks.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.compute_confidence">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">compute_confidence</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#compute_confidence"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.compute_confidence" title="Link to this definition"></a></dt>
<dd><p>Computes the confidence score for a translation
based on model output scores.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>scores</strong> (<em>list</em>) – List of token logits from the model output.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Average confidence score (0.0 to 1.0).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.compute_rating">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">compute_rating</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translated_text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_confidence</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#compute_rating"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.compute_rating" title="Link to this definition"></a></dt>
<dd><p>Computes a rating for the translated text based on
grammar errors and model confidence.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tool</strong> (<em>LanguageTool</em>) – The grammar checker tool.</p></li>
<li><p><strong>translated_text</strong> (<em>str</em>) – The text to evaluate.</p></li>
<li><p><strong>total_confidence</strong> (<em>float</em>) – Confidence score from the translation model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A rating between 0 and 10 for the translation quality.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.detect_language">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">detect_language</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#detect_language"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.detect_language" title="Link to this definition"></a></dt>
<dd><p>Detects the language of the input text using a FastText model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text to analyze.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>ISO 639-1 language code for the detected language.</dt><dd><p>Defaults to ‘eng’ if the language is not recognized.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.direct_translation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">direct_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_beams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#direct_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.direct_translation" title="Link to this definition"></a></dt>
<dd><p>Function to load a fine-tuned MarianMT model
and perform translation on a DataFrame column with a progress bar.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>DataFrame</em>) – DataFrame containing the texts to be translated.</p></li>
<li><p><strong>model_name</strong> (<em>list</em>) – List of Model and Tokenizer for specific language</p></li>
<li><p><strong>source_column</strong> (<em>str</em>) – The name of the column in the DataFrame containing
the text in the source language.</p></li>
<li><p><strong>max_length</strong> (<em>int</em>) – Maximum length of input sequences. Defaults to 128.</p></li>
<li><p><strong>num_beams</strong> (<em>int</em>) – Number of beams for beam search. Defaults to 3.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Updated translation list</p></li>
<li><p>Updated confidence list.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.generating_translation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">generating_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_beams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#generating_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.generating_translation" title="Link to this definition"></a></dt>
<dd><p>Generates translations for the input text using a MarianMT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tokenizer</strong> (<em>MarianTokenizer</em>) – The tokenizer for the MarianMT model.</p></li>
<li><p><strong>model</strong> (<em>MarianMTModel</em>) – The MarianMT model for translation.</p></li>
<li><p><strong>data</strong> (<em>str</em>) – The input text to translate.</p></li>
<li><p><strong>num_beams</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of beams. Defaults to 5.</p></li>
<li><p><strong>max_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Max sequence length. Defaults to 512.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>str: The translated text.</p></li>
<li><p>float: Confidence score for the translation.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.indirect_translation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">indirect_translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_beams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#indirect_translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.indirect_translation" title="Link to this definition"></a></dt>
<dd><p>Performs indirect translation via an intermediate language
(e.g., Romanian to English to Arabic).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>str</em>) – The input text for translation.</p></li>
<li><p><strong>model_config</strong> (<em>dict</em>) – Model and Tokenizer config.</p></li>
<li><p><strong>translation_list</strong> (<em>list</em>) – List to store translations.</p></li>
<li><p><strong>confidence_list</strong> (<em>list</em>) – List to store confidence scores.</p></li>
<li><p><strong>max_length</strong> (<em>int</em><em>, </em><em>optional</em>) – Max sequence length. Defaults to 512.</p></li>
<li><p><strong>num_beams</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of beams. Defaults to 5.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Updated translation list</p></li>
<li><p>Updated confidence list.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.inference">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.inference" title="Link to this definition"></a></dt>
<dd><p>Performs full inference for translation, including language detection,
preprocessing, translation, and rating computation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text to translate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>list: Translations in the target language(s).</p></li>
<li><p>list: Detected source languages.</p></li>
<li><p>list: Ratings for translation quality.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.initializing_model">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">initializing_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#initializing_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.initializing_model" title="Link to this definition"></a></dt>
<dd><p>Initializes and loads a MarianMT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_name</strong> (<em>str</em>) – The name or path of the MarianMT model.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded MarianMT model.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MarianMTModel</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.initializing_tokenizer">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">initializing_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tokenizer_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#initializing_tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.initializing_tokenizer" title="Link to this definition"></a></dt>
<dd><p>Initializes and loads a MarianMT tokenizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>tokenizer_name</strong> (<em>str</em>) – The name or path of the MarianMT tokenizer.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The loaded tokenizer.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>MarianTokenizer</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.mlflow_logging">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">mlflow_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_language</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_language</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">original</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rating</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#mlflow_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.mlflow_logging" title="Link to this definition"></a></dt>
<dd><p>Logs translation results and metadata to an MLflow experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_language</strong> (<em>str</em>) – The language of the original text.</p></li>
<li><p><strong>target_language</strong> (<em>str</em>) – The language of the translation.</p></li>
<li><p><strong>original</strong> (<em>str</em>) – The original input text.</p></li>
<li><p><strong>translation</strong> (<em>str</em>) – The translated text.</p></li>
<li><p><strong>rating</strong> (<em>float</em>) – Quality rating for the translation.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.process_chunk">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">process_chunk</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chunk_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translation_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#process_chunk"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.process_chunk" title="Link to this definition"></a></dt>
<dd><p>Processes text chunks for translation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chunk_list</strong> (<em>list</em>) – List of text chunks.</p></li>
<li><p><strong>code</strong> (<em>str</em>) – Language code for the input text.</p></li>
<li><p><strong>translation_func</strong> (<em>function</em>) – The translation function
(direct or indirect).</p></li>
<li><p><strong>translation_list</strong> (<em>list</em>) – List to store translations.</p></li>
<li><p><strong>confidence_list</strong> (<em>list</em>) – List to store confidence scores.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>Updated translation list</p></li>
<li><p>Updated confidence list.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.inference.processing">
<span class="sig-prename descclassname"><span class="pre">lingowiz.inference.</span></span><span class="sig-name descname"><span class="pre">processing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">code</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference.html#processing"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference.processing" title="Link to this definition"></a></dt>
<dd><p>Preprocesses the text based on the detected language and retrieves
the appropriate model configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> (<em>str</em>) – The input text to preprocess.</p></li>
<li><p><strong>code</strong> (<em>str</em>) – The ISO 639-1 code of the detected language.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>str: Preprocessed text.</p></li>
<li><p>dict: Model configuration for translation.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lingowiz.inference_preprocessing">
<span id="lingowiz-inference-preprocessing-module"></span><h2>lingowiz.inference_preprocessing module<a class="headerlink" href="#module-lingowiz.inference_preprocessing" title="Link to this heading"></a></h2>
<p>Module: inference_preprocess.py</p>
<p>This module provides functionality for preprocessing text input during inference.
It includes a <code class="docutils literal notranslate"><span class="pre">TextPreprocessor</span></code> class with methods for handling language-specific
text normalization, cleaning, and transformation. The preprocessing ensures that
text data is standardized and ready for model inference.</p>
<section id="classes">
<h3>Classes:<a class="headerlink" href="#classes" title="Link to this heading"></a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><strong>TextPreprocessor</strong>:</dt><dd><p>A class that encapsulates language-specific preprocessing logic, supporting multiple languages.</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="methods">
<h3>Methods:<a class="headerlink" href="#methods" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>The methods inside <code class="docutils literal notranslate"><span class="pre">TextPreprocessor</span></code> include:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_english</span></code>: Preprocesses English text (e.g., handling contractions).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_french</span></code>: Handles French-specific accent and punctuation normalization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_italian</span></code>: Processes Italian text with punctuation normalization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_russian</span></code>: Removes extra whitespace from Russian text.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_turkish</span></code>: Handles Turkish-specific lowercase and punctuation rules.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_spanish</span></code>: Normalizes Spanish accents and whitespace.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_greek</span></code>: Normalizes Greek text, including accents and punctuation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">preprocess_romania</span></code>: Handles Romanian-specific text transformations.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="utilities">
<h3>Utilities:<a class="headerlink" href="#utilities" title="Link to this heading"></a></h3>
<dl class="simple">
<dt>Language-agnostic helper methods include:</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__process_medical_data</span></code>: Processes medical data, expanding abbreviations and cleaning text.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__expand_abbreviations</span></code>: Expands abbreviations using a dictionary.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__add_space_between_letters_and_numbers</span></code>: Adds spaces between letters and numbers.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__remove_extra_whitespace</span></code>: Cleans up redundant spaces in text.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__normalize_*</span></code>: Various normalization methods for punctuation and accents.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="usage">
<h3>Usage:<a class="headerlink" href="#usage" title="Link to this heading"></a></h3>
<p>This module is intended to standardize text input for natural language processing tasks,
ensuring compatibility with models during inference.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">inference_preprocess</span> <span class="kn">import</span> <span class="n">TextPreprocessor</span>

<span class="c1"># Create a preprocessor for English</span>
<span class="n">preprocessor</span> <span class="o">=</span> <span class="n">TextPreprocessor</span><span class="p">(</span><span class="n">language</span><span class="o">=</span><span class="s2">&quot;eng&quot;</span><span class="p">)</span>

<span class="c1"># Preprocess some text</span>
<span class="n">clean_text</span> <span class="o">=</span> <span class="n">preprocessor</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="s2">&quot;I&#39;m feeling great! Let&#39;s preprocess this text.&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">clean_text</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id3">
<h3>Dependencies:<a class="headerlink" href="#id3" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">re</span></code>: Regular expressions for text pattern matching.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unicodedata</span></code>: Unicode support for diacritic normalization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lingowiz.utils.abbreviation_dict</span></code>: A dictionary of abbreviations for medical data expansion.</p></li>
</ul>
</section>
<section id="note">
<h3>Note:<a class="headerlink" href="#note" title="Link to this heading"></a></h3>
<p>Extend or customize the <code class="docutils literal notranslate"><span class="pre">TextPreprocessor</span></code> class for additional languages or
preprocessing requirements as needed.</p>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lingowiz.inference_preprocessing.</span></span><span class="sig-name descname"><span class="pre">TextPreprocessor</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">language</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A text preprocessing class for handling
language-specific transformations and normalizations.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.language">
<span class="sig-name descname"><span class="pre">language</span></span><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.language" title="Link to this definition"></a></dt>
<dd><p>The ISO 639-3 language code for preprocessing.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_english">
<span class="sig-name descname"><span class="pre">preprocess_english</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_english"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_english" title="Link to this definition"></a></dt>
<dd><p>Preprocesses English text with medical data handling,
contraction normalization, and whitespace cleaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The English text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed English text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_french">
<span class="sig-name descname"><span class="pre">preprocess_french</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_french"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_french" title="Link to this definition"></a></dt>
<dd><p>Preprocesses French text with accent normalization,
punctuation handling, and whitespace cleaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The French text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed French text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_greek">
<span class="sig-name descname"><span class="pre">preprocess_greek</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_greek"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_greek" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Greek text with accent normalization
and whitespace cleaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The Greek text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed Greek text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_italian">
<span class="sig-name descname"><span class="pre">preprocess_italian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_italian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_italian" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Italian text with punctuation
normalization and whitespace cleaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The Italian text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed Italian text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_romania">
<span class="sig-name descname"><span class="pre">preprocess_romania</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_romania"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_romania" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Romanian text with lowercasing,
punctuation cleaning, and diacritic normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The Romanian text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed Romanian text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_russian">
<span class="sig-name descname"><span class="pre">preprocess_russian</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_russian"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_russian" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Russian text by removing extra whitespace.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The Russian text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed Russian text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_spanish">
<span class="sig-name descname"><span class="pre">preprocess_spanish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_spanish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_spanish" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Spanish text with accent normalization
and whitespace cleaning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The Spanish text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed Spanish text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.preprocess_turkish">
<span class="sig-name descname"><span class="pre">preprocess_turkish</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.preprocess_turkish"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.preprocess_turkish" title="Link to this definition"></a></dt>
<dd><p>Preprocesses Turkish text with lowercase handling
and punctuation normalization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The Turkish text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed Turkish text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.inference_preprocessing.TextPreprocessor.process">
<span class="sig-name descname"><span class="pre">process</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/inference_preprocessing.html#TextPreprocessor.process"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.inference_preprocessing.TextPreprocessor.process" title="Link to this definition"></a></dt>
<dd><p>Preprocesses text based on the specified language.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – The input text to preprocess.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The preprocessed text.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-lingowiz.metrics">
<span id="lingowiz-metrics-module"></span><h2>lingowiz.metrics module<a class="headerlink" href="#module-lingowiz.metrics" title="Link to this heading"></a></h2>
<p>Function: translation</p>
<p>This function generates translations for a specified column in a DataFrame
using a fine-tuned MarianMT model.</p>
<dl class="field-list simple">
<dt class="field-odd">param df_test<span class="colon">:</span></dt>
<dd class="field-odd"><p>The DataFrame containing the texts to be translated.</p>
</dd>
<dt class="field-even">type df_test<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
<dt class="field-odd">param model<span class="colon">:</span></dt>
<dd class="field-odd"><p>The fine-tuned MarianMT model used for translation.</p>
</dd>
<dt class="field-even">type model<span class="colon">:</span></dt>
<dd class="field-even"><p>transformers.MarianMTModel</p>
</dd>
<dt class="field-odd">param tokenizer<span class="colon">:</span></dt>
<dd class="field-odd"><p>The tokenizer corresponding to the MarianMT model.</p>
</dd>
<dt class="field-even">type tokenizer<span class="colon">:</span></dt>
<dd class="field-even"><p>transformers.MarianTokenizer</p>
</dd>
<dt class="field-odd">param source_column<span class="colon">:</span></dt>
<dd class="field-odd"><p>The name of the column in the DataFrame that contains the source texts.</p>
</dd>
<dt class="field-even">type source_column<span class="colon">:</span></dt>
<dd class="field-even"><p>str</p>
</dd>
<dt class="field-odd">param batch_size<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of texts to process in each batch (default is 8).</p>
</dd>
<dt class="field-even">type batch_size<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param max_length<span class="colon">:</span></dt>
<dd class="field-odd"><p>The maximum length of input sequences for translation (default is 128).</p>
</dd>
<dt class="field-even">type max_length<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">param num_beams<span class="colon">:</span></dt>
<dd class="field-odd"><p>The number of beams for beam search during inference (default is 2).</p>
</dd>
<dt class="field-even">type num_beams<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>A list of translated texts.</p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>list</p>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">transformers</span> <span class="kn">import</span> <span class="n">MarianTokenizer</span><span class="p">,</span> <span class="n">MarianMTModel</span>
<span class="kn">from</span> <span class="nn">lingowiz.metrics</span> <span class="kn">import</span> <span class="n">translation</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># Load model and tokenizer</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MarianMTModel</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;Helsinki-NLP/opus-mt-en-ar&quot;</span><span class="p">)</span>
<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">MarianTokenizer</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;Helsinki-NLP/opus-mt-en-ar&quot;</span><span class="p">)</span>

<span class="c1"># Prepare test data</span>
<span class="n">df_test</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s2">&quot;English&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Hello world!&quot;</span><span class="p">,</span> <span class="s2">&quot;How are you?&quot;</span><span class="p">]})</span>

<span class="c1"># Translate</span>
<span class="n">translations</span> <span class="o">=</span> <span class="n">translation</span><span class="p">(</span>
    <span class="n">df_test</span><span class="o">=</span><span class="n">df_test</span><span class="p">,</span>
    <span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span>
    <span class="n">tokenizer</span><span class="o">=</span><span class="n">tokenizer</span><span class="p">,</span>
    <span class="n">source_column</span><span class="o">=</span><span class="s2">&quot;English&quot;</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">translations</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.metrics.evaluation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.metrics.</span></span><span class="sig-name descname"><span class="pre">evaluation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/metrics.html#evaluation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.metrics.evaluation" title="Link to this definition"></a></dt>
<dd><p>Evaluate the model predictions using BLEU, chrF, and BERTScore metrics.</p>
<p>Args:
- df_test: DataFrame containing the test data, including reference translations.</p>
<p>This function prints the computed metrics for BLEU, chrF, and BERTScore.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.metrics.metric_compute">
<span class="sig-prename descclassname"><span class="pre">lingowiz.metrics.</span></span><span class="sig-name descname"><span class="pre">metric_compute</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predicted_texts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/metrics.html#metric_compute"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.metrics.metric_compute" title="Link to this definition"></a></dt>
<dd><p>Evaluates the model predictions using BLEU, chrF, and BERTScore metrics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>df_test</strong> (<em>pd.DataFrame</em>) – A DataFrame containing the test data, including reference translations.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This function does not return any value. It computes and prints the
metrics for BLEU, chrF, and BERTScore.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The computed metrics are displayed in the console for review.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.metrics.mlflow_logging">
<span class="sig-prename descclassname"><span class="pre">lingowiz.metrics.</span></span><span class="sig-name descname"><span class="pre">mlflow_logging</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_language</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_language</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_bleu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_chrf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_bert</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/metrics.html#mlflow_logging"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.metrics.mlflow_logging" title="Link to this definition"></a></dt>
<dd><p>Logs translation evaluation metrics (BLEU, CHRF, and BERT scores) to an MLflow experiment.</p>
<p>This function creates or retrieves an MLflow experiment specific to a source-target language pair,
and logs the provided evaluation metrics. If the experiment already exists, the metrics are appended
to the latest run; otherwise, a new experiment and run are created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_language</strong> (<em>str</em>) – The ISO 639-1 code or name of the source language.</p></li>
<li><p><strong>target_language</strong> (<em>str</em>) – The ISO 639-1 code or name of the target language.</p></li>
<li><p><strong>metric_bleu</strong> (<em>float</em>) – The BLEU score for the translation quality.</p></li>
<li><p><strong>metric_chrf</strong> (<em>float</em>) – The CHRF score for the translation quality.</p></li>
<li><p><strong>metric_bert</strong> (<em>float</em>) – The BERT score for the semantic similarity.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>This function does not return a value. It logs data directly to MLflow.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>If an MLflow experiment for the given source-target language pair does not exist, a new experiment is created automatically.</p></li>
<li><p>Metrics are logged as parameters in the current or newly created MLflow run.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.metrics.translation">
<span class="sig-prename descclassname"><span class="pre">lingowiz.metrics.</span></span><span class="sig-name descname"><span class="pre">translation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_test</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source_column</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">128</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_beams</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/metrics.html#translation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.metrics.translation" title="Link to this definition"></a></dt>
<dd><p>Function to load a fine-tuned MarianMT model and perform translation on
a DataFrame column using Swifter for parallel processing.</p>
<p>Parameters
- df_test: DataFrame containing the texts to be translated.
- model: The fine-tuned MarianMT model.
- tokenizer: The tokenizer for the model.
- source_column: The name of the column in the DataFrame that contains the text in the source language.
- batch_size: Number of texts to process in each batch (default is 8).
- max_length: The maximum length of input sequences for translation (default is 128).
- num_beams: The number of beams for beam search during inference (default is 2).</p>
<p>Returns:
- translated_texts: A list of translated texts.</p>
</dd></dl>

</section>
<section id="module-lingowiz.train">
<span id="lingowiz-train-module"></span><h2>lingowiz.train module<a class="headerlink" href="#module-lingowiz.train" title="Link to this heading"></a></h2>
<p>Module: train.py</p>
<p>This module provides a complete pipeline for fine-tuning machine translation models
using Hugging Face’s <code class="docutils literal notranslate"><span class="pre">transformers</span></code> library and managing training experiments with MLflow.
It supports data preprocessing, tokenization, model training, and logging results to Hugging Face
and MLflow.</p>
<section id="id4">
<h3>Features:<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<ol class="arabic simple">
<li><dl class="simple">
<dt><strong>Data Splitting</strong>:</dt><dd><ul class="simple">
<li><p>Splits data into training and evaluation sets.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Model Training</strong>:</dt><dd><ul class="simple">
<li><p>Fine-tunes a MarianMT model on custom datasets.</p></li>
<li><p>Supports freezing encoder and decoder layers for efficient fine-tuning.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Tokenization</strong>:</dt><dd><ul class="simple">
<li><p>Tokenizes input and target sentences for training and evaluation.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>MLflow Integration</strong>:</dt><dd><ul class="simple">
<li><p>Logs training hyperparameters, metrics, and models.</p></li>
<li><p>Automatically creates or updates MLflow experiments.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Hugging Face Integration</strong>:</dt><dd><ul class="simple">
<li><p>Saves and uploads trained models to the Hugging Face Model Hub.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><strong>Callbacks</strong>:</dt><dd><ul class="simple">
<li><p>Includes a callback to clear GPU memory after each epoch.</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</section>
<section id="id5">
<h3>Dependencies:<a class="headerlink" href="#id5" title="Link to this heading"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">transformers</span></code>: For Hugging Face models and training utilities.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mlflow</span></code>: For experiment tracking and logging.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pandas</span></code>: For data manipulation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets</span></code>: For handling datasets in Hugging Face format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">torch</span></code>: For GPU/CPU compatibility during training.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tqdm</span></code>: For progress visualization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">requests</span></code>: For making API calls to external services.</p></li>
</ul>
</section>
<section id="id6">
<h3>Example Usage:<a class="headerlink" href="#id6" title="Link to this heading"></a></h3>
<p>This module is designed for training machine translation models on custom datasets, integrating
key utilities for tokenization, training, logging, and uploading models.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">translation_training_pipeline</span> <span class="kn">import</span> <span class="n">training_pipeline</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;translation_data.csv&quot;</span><span class="p">)</span>
<span class="n">training_pipeline</span><span class="p">(</span>
    <span class="n">df</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">src</span><span class="o">=</span><span class="s2">&quot;English&quot;</span><span class="p">,</span>
    <span class="n">base_model</span><span class="o">=</span><span class="s2">&quot;Helsinki-NLP/opus-mt-en-ar&quot;</span><span class="p">,</span>
    <span class="n">steps</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="o">=</span><span class="mf">5e-5</span><span class="p">,</span>
    <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
    <span class="n">warmup</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
    <span class="n">trg_language</span><span class="o">=</span><span class="s2">&quot;Arabic&quot;</span><span class="p">,</span>
    <span class="n">layer</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="py class">
<dt class="sig sig-object py" id="lingowiz.train.EmptyCacheCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">EmptyCacheCallback</span></span><a class="reference internal" href="_modules/lingowiz/train.html#EmptyCacheCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.EmptyCacheCallback" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">TrainerCallback</span></code></p>
<p>A callback to clear GPU memory after each training epoch to prevent memory overflow.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lingowiz.train.EmptyCacheCallback.on_epoch_end">
<span class="sig-name descname"><span class="pre">on_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">control</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#EmptyCacheCallback.on_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.EmptyCacheCallback.on_epoch_end" title="Link to this definition"></a></dt>
<dd><p>Clears the GPU cache after the end of an epoch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> (<em>TrainingArguments</em>) – Training arguments.</p></li>
<li><p><strong>state</strong> (<em>TrainerState</em>) – Trainer state.</p></li>
<li><p><strong>control</strong> (<em>TrainerControl</em>) – Trainer control object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.initialize">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">initialize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_eval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#initialize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.initialize" title="Link to this definition"></a></dt>
<dd><p>Initializes the tokenizer, model, and tokenized datasets for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_train</strong> (<em>Dataset</em>) – Training dataset.</p></li>
<li><p><strong>data_eval</strong> (<em>Dataset</em>) – Evaluation dataset.</p></li>
<li><p><strong>special_model</strong> (<em>str</em>) – Special model configuration (optional).</p></li>
<li><p><strong>base_model</strong> (<em>str</em>) – Pretrained MarianMT model name or path.</p></li>
<li><p><strong>src</strong> (<em>str</em>) – Source language column in the dataset.</p></li>
<li><p><strong>trg</strong> (<em>str</em>) – Target language column in the dataset.</p></li>
<li><p><strong>layer</strong> (<em>int</em><em>, </em><em>optional</em>) – Layer freezing configuration. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>Dataset: Tokenized training dataset.</p></li>
<li><p>Dataset: Tokenized evaluation dataset.</p></li>
<li><p>MarianMTModel: Initialized MarianMT model.</p></li>
<li><p>MarianTokenizer: Initialized tokenizer.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.log_params">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">log_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup_steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log_history</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#log_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.log_params" title="Link to this definition"></a></dt>
<dd><p>Logs training hyperparameters, data, and model metadata to MLflow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>base_model</strong> (<em>str</em>) – Base MarianMT model used for training.</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – Total training steps.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training and evaluation.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – Learning rate used during training.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of training epochs.</p></li>
<li><p><strong>warmup_steps</strong> (<em>int</em>) – Number of warmup steps for learning rate scheduling.</p></li>
<li><p><strong>experiment_name</strong> (<em>str</em>) – Name of the MLflow experiment.</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Training dataset.</p></li>
<li><p><strong>model</strong> (<em>MarianMTModel</em>) – Trained MarianMT model.</p></li>
<li><p><strong>tokenizer</strong> (<em>MarianTokenizer</em>) – Tokenizer used for training.</p></li>
<li><p><strong>log_history</strong> (<em>list</em>) – Training logs for parameter logging.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.split_eval">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">split_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#split_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.split_eval" title="Link to this definition"></a></dt>
<dd><p>Splits a dataset into training and evaluation subsets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> (<em>Dataset</em>) – The dataset to split.</p></li>
<li><p><strong>eval_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Proportion of the dataset for evaluation. Defaults to 0.2.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility. Defaults to 42.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>Dataset: Training subset.</p></li>
<li><p>Dataset: Evaluation subset.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.split_test">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">split_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#split_test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.split_test" title="Link to this definition"></a></dt>
<dd><p>Splits the DataFrame into training and testing sets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – The input DataFrame to split.</p></li>
<li><p><strong>test_size</strong> (<em>float</em><em>, </em><em>optional</em>) – Fraction of the data to reserve for testing. Defaults to 0.2.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>optional</em>) – Random seed for reproducibility. Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>pd.DataFrame: Training set.</p></li>
<li><p>pd.DataFrame: Testing set.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.tokenize_function">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">tokenize_function</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trg</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#tokenize_function"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.tokenize_function" title="Link to this definition"></a></dt>
<dd><p>Tokenizes source and target texts for training and evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>Dataset</em>) – The dataset containing source and target texts.</p></li>
<li><p><strong>tokenizer</strong> (<em>MarianTokenizer</em>) – Tokenizer for the MarianMT model.</p></li>
<li><p><strong>src</strong> (<em>str</em>) – Name of the source language column in the dataset.</p></li>
<li><p><strong>trg</strong> (<em>str</em>) – Name of the target language column in the dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tokenized input and target sequences, including labels.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.train">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenized_datasets_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenized_datasets_eval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.train" title="Link to this definition"></a></dt>
<dd><p>Trains a MarianMT model on tokenized datasets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>MarianMTModel</em>) – The MarianMT model to fine-tune.</p></li>
<li><p><strong>tokenized_datasets_train</strong> (<em>Dataset</em>) – Tokenized training dataset.</p></li>
<li><p><strong>tokenized_datasets_eval</strong> (<em>Dataset</em>) – Tokenized evaluation dataset.</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – Total training steps.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training and evaluation.</p></li>
<li><p><strong>lr</strong> (<em>float</em>) – Learning rate for optimization.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of training epochs.</p></li>
<li><p><strong>warmup</strong> (<em>int</em>) – Number of warmup steps for learning rate scheduling.</p></li>
<li><p><strong>tokenizer</strong> (<em>MarianTokenizer</em>) – Tokenizer for the MarianMT model.</p></li>
<li><p><strong>bool_model</strong> (<em>bool</em>) – Reserved for additional configuration (unused in this function).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>A tuple containing:</dt><dd><ul class="simple">
<li><p>Trainer: Hugging Face Trainer object after training.</p></li>
<li><p>TrainOutput: Training metrics.</p></li>
</ul>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lingowiz.train.training_pipeline">
<span class="sig-prename descclassname"><span class="pre">lingowiz.train.</span></span><span class="sig-name descname"><span class="pre">training_pipeline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epochs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">warmup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">trg_language</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Arabic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lingowiz/train.html#training_pipeline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lingowiz.train.training_pipeline" title="Link to this definition"></a></dt>
<dd><p>Executes the end-to-end training pipeline for fine-tuning a MarianMT model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – Input dataset for training and evaluation.</p></li>
<li><p><strong>src</strong> (<em>str</em>) – Source language column name in the dataset.</p></li>
<li><p><strong>base_model</strong> (<em>str</em>) – Pretrained MarianMT model name or path.</p></li>
<li><p><strong>steps</strong> (<em>int</em>) – Total training steps.</p></li>
<li><p><strong>batch_size</strong> (<em>int</em>) – Batch size for training and evaluation.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – Learning rate for fine-tuning.</p></li>
<li><p><strong>epochs</strong> (<em>int</em>) – Number of training epochs.</p></li>
<li><p><strong>warmup</strong> (<em>int</em>) – Number of warmup steps for learning rate scheduling.</p></li>
<li><p><strong>special_model</strong> (<em>str</em><em>, </em><em>optional</em>) – Custom model configuration. Defaults to None.</p></li>
<li><p><strong>trg_language</strong> (<em>str</em><em>, </em><em>optional</em>) – Target language name. Defaults to “Arabic”.</p></li>
<li><p><strong>layer</strong> (<em>int</em><em>, </em><em>optional</em>) – Layer freezing configuration. Defaults to 0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lingowiz.utils">
<span id="lingowiz-utils-module"></span><h2>lingowiz.utils module<a class="headerlink" href="#module-lingowiz.utils" title="Link to this heading"></a></h2>
</section>
<section id="module-lingowiz">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-lingowiz" title="Link to this heading"></a></h2>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Patrick Saadde.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>